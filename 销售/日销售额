select bas_project.id,                             -- 项目id
       bas_project.project_name,                   -- 项目名称
       bas_project.project_type,                   -- 经营类型(1001:购物中心 1002:商业街 1003:写字楼 1004：轻资产)
       bas_project.project_name_short,             -- 项目简称
       bas_region.id,                              -- 区域id
       bas_region.region_name,                     -- 区域名称
       bas_city.id,                                -- 城市id
       bas_city.city_name,                         -- 城市名称
       opt_income_record_day.cont_id,              -- 合同id
       opt_income_record_day.income_date,          -- 销售额日期
       opt_income_record_day.confirm_sales_volume, -- 确认销售额
       opt_income_record_day.check_status_sales,   -- 审核状态
       bas_holidays_date.is_holiday,               -- 节假日 （1：是  0 ： 否）
       opt_cont.tenant_name,                       -- 商家名称
       opt_cont.tenant_id,                         -- 商家id
       current_date                                -- ETL时间

from ods.ods_bc_yw_pms_business_db_opt_income_record_day_dt opt_income_record_day
         left join ods.ods_bc_yw_pms_business_db_bas_project_dt bas_project
                   on opt_income_record_day.project_id = bas_project.id and bas_project.is_deleted = '0'
         left join ods.ods_bc_yw_pms_business_db_bas_region_dt bas_region
                   on bas_project.region_id = bas_region.id and bas_region.is_deleted = '0'
         left join ods.ods_bc_yw_pms_business_db_bas_city_dt bas_city
                   on bas_project.city_id = bas_city.id and bas_city.is_deleted = '0'
         left join ods.ods_bc_yw_pms_business_db_bas_holidays_date_dt bas_holidays_date
                   on opt_income_record_day.project_id = bas_holidays_date.project_id
                       and opt_income_record_day.income_date = bas_holidays_date.holidays_date and
                      bas_holidays_date.is_deleted = '0'
         left join ods.ods_bc_yw_pms_business_db_opt_cont_dt opt_cont
                   on opt_income_record_day.cont_id = opt_cont.id and opt_cont.is_deleted = '0'
where opt_income_record_day.is_deleted = '0';